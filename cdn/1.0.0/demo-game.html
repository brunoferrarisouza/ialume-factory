<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üéÆ iAlume Game - Teste Completo</title>
    
    <!-- Base CSS -->
    <link rel="stylesheet" href="./base.css">
    
    <style>
        body {
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .loading-screen {
            text-align: center;
            color: white;
            padding: 40px;
        }
        
        .loading-screen h1 {
            font-size: 3em;
            margin: 0 0 20px 0;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }
        
        .spinner {
            border: 5px solid rgba(255,255,255,0.3);
            border-top: 5px solid white;
            border-radius: 50%;
            width: 60px;
            height: 60px;
            animation: spin 1s linear infinite;
            margin: 20px auto;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <div class="loading-screen" id="loadingScreen">
        <h1>‚ö° iAlume</h1>
        <div class="spinner"></div>
        <p>Carregando jogo...</p>
    </div>

    <!-- Container do Jogo (oculto inicialmente) -->
    <div id="game-container" style="display: none;"></div>

    <!-- Configura√ß√£o do Jogo -->
    <script>
        window.GAME_CONFIG = {
            "gameId": "demo-sistema-solar",
            "title": "Desafio: Sistema Solar",
            "modality": "quiz",
            "mechanic": "escalada",
            "theme": {
                "primaryColor": "#667eea",
                "backgroundColor": "#1a1a2e"
            },
            "phases": [
                {
                    "phaseNumber": 1,
                    "question": "Qual √© o planeta mais pr√≥ximo do Sol?",
                    "options": [
                        "Merc√∫rio",
                        "V√™nus",
                        "Terra",
                        "Marte"
                    ],
                    "correctAnswer": 0,
                    "explanation": "Merc√∫rio √© o planeta mais pr√≥ximo do Sol, com uma dist√¢ncia m√©dia de 57,9 milh√µes de km. Sua √≥rbita √© a mais r√°pida do Sistema Solar!",
                    "concept": "Sistema Solar - Planetas Interiores",
                    "metaphor": "Como o primeiro corredor em uma corrida ao redor do Sol"
                },
                {
                    "phaseNumber": 2,
                    "question": "Quantos planetas existem no Sistema Solar?",
                    "options": [
                        "7 planetas",
                        "8 planetas",
                        "9 planetas",
                        "10 planetas"
                    ],
                    "correctAnswer": 1,
                    "explanation": "Existem 8 planetas no Sistema Solar desde 2006, quando Plut√£o foi reclassificado como planeta an√£o pela Uni√£o Astron√¥mica Internacional.",
                    "concept": "Sistema Solar - Composi√ß√£o",
                    "metaphor": "Uma fam√≠lia de oito irm√£os orbitando ao redor do pai Sol"
                },
                {
                    "phaseNumber": 3,
                    "question": "Qual √© o maior planeta do Sistema Solar?",
                    "options": [
                        "Saturno",
                        "Netuno",
                        "J√∫piter",
                        "Urano"
                    ],
                    "correctAnswer": 2,
                    "explanation": "J√∫piter √© o maior planeta, com um di√¢metro de cerca de 142.984 km - mais de 11 vezes o di√¢metro da Terra! Ele tem mais massa que todos os outros planetas juntos.",
                    "concept": "Sistema Solar - Gigantes Gasosos",
                    "metaphor": "O gigante gentil que protege os planetas internos com sua gravidade"
                },
                {
                    "phaseNumber": 4,
                    "question": "Qual planeta √© conhecido como 'Planeta Vermelho'?",
                    "options": [
                        "V√™nus",
                        "Marte",
                        "J√∫piter",
                        "Saturno"
                    ],
                    "correctAnswer": 1,
                    "explanation": "Marte √© chamado de Planeta Vermelho devido ao √≥xido de ferro (ferrugem) em sua superf√≠cie, que lhe d√° uma colora√ß√£o avermelhada caracter√≠stica.",
                    "concept": "Sistema Solar - Marte",
                    "metaphor": "Um deserto enferrujado flutuando no espa√ßo"
                }
            ]
        };
        
        console.log('‚úÖ Configura√ß√£o do jogo carregada:', window.GAME_CONFIG);
    </script>

    <!-- Scripts do Sistema (ordem importa!) -->
    <!-- 1. Base: Estado do jogo, √°udio, navega√ß√£o -->
    <script src="./base.js"></script>
    
    <!-- 2. Game Engine: Pontua√ß√£o e registro de resultados -->
    <script src="./game-engine.js"></script>
    
    <!-- 3. Integra√ß√£o Bubble: Comunica√ß√£o com plataforma externa -->
    <script src="./bubble-integration.js"></script>
    
    <!-- 4. Mec√¢nica Visual: Escalada -->
    <script src="./mechanics/escalada.js"></script>
    
    <!-- 5. Modalidade: Quiz -->
    <script src="./modalities/quiz.js"></script>

    <!-- Script de Inicializa√ß√£o -->
    <script>
        console.log('üéÆ Iniciando sistema iAlume...');
        
        // Aguardar carregamento completo do DOM
        document.addEventListener('DOMContentLoaded', function() {
            console.log('üìÑ DOM carregado');
            
            // Verificar componentes
            console.log('üîç Verificando componentes:');
            console.log('- gameState:', typeof gameState);
            console.log('- GAME_ENGINE:', typeof GAME_ENGINE);
            console.log('- BUBBLE:', typeof BUBBLE);
            console.log('- ESCALADA:', typeof ESCALADA);
            console.log('- QUIZ:', typeof QUIZ);
            console.log('- initAudio:', typeof initAudio);
            
            // Tentar inicializar o jogo
            try {
                // Esconder loading
                document.getElementById('loadingScreen').style.display = 'none';
                document.getElementById('game-container').style.display = 'block';
                
                // Inicializar √°udio
                if (typeof initAudio === 'function') {
                    initAudio();
                    console.log('‚úÖ √Åudio inicializado');
                } else {
                    console.warn('‚ö†Ô∏è initAudio n√£o dispon√≠vel');
                }
                
                // Verificar se QUIZ existe e tem m√©todo init
                if (typeof QUIZ !== 'undefined' && typeof QUIZ.init === 'function') {
                    console.log('‚úÖ QUIZ dispon√≠vel, iniciando primeira fase...');
                    
                    // Inicializar primeira fase
                    QUIZ.init(window.GAME_CONFIG.phases[0]);
                    
                    console.log('üéÆ Jogo iniciado com sucesso!');
                } else {
                    throw new Error('Modalidade QUIZ n√£o est√° dispon√≠vel');
                }
                
            } catch (error) {
                console.error('‚ùå Erro ao inicializar:', error);
                
                // Mostrar erro na tela
                document.body.innerHTML = `
                    <div style="text-align: center; padding: 40px; color: white;">
                        <h1>‚ùå Erro ao Carregar</h1>
                        <p style="background: rgba(0,0,0,0.3); padding: 20px; border-radius: 10px; max-width: 600px; margin: 20px auto;">
                            ${error.message}
                        </p>
                        <p>Verifique o console (F12) para mais detalhes</p>
                    </div>
                `;
            }
        });
        
        // Log adicional quando window carregar
        window.addEventListener('load', function() {
            console.log('üåê Window carregada');
            console.log('üìä Status final dos componentes:');
            console.log('- gameState:', typeof gameState);
            console.log('- GAME_ENGINE:', typeof GAME_ENGINE);
            console.log('- ESCALADA:', typeof ESCALADA);
            console.log('- QUIZ:', typeof QUIZ);
        });
    </script>
</body>
</html>

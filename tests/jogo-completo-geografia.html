<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lume e a Montanha do Conhecimento - Geografia</title>

    <!-- Carregar CSS base -->
    <link rel="stylesheet" href="../base/styles/base.css?v=1762463012">

    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: #f8f9fa;
            overflow-x: hidden;
        }

        .game-container {
            position: relative;
            width: 100%;
            height: 100vh;
            overflow: hidden;
            background: white;
        }

        /* Fases - Agora usando CSS do base.css */

        .phase.active {
            opacity: 1;
            visibility: visible;
        }

        /* Fase 0 - Abertura */
        .welcome-screen {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 30px;
            padding: 50px 40px;
            text-align: center;
            color: white;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }

        .welcome-screen h1 {
            font-size: 2.5rem;
            margin-bottom: 20px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .welcome-screen .lume-intro {
            font-size: 5rem;
            margin: 30px 0;
            animation: float 3s ease-in-out infinite;
            filter: drop-shadow(0 0 20px rgba(255,255,255,0.8));
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-20px); }
        }

        .welcome-screen p {
            font-size: 1.3rem;
            line-height: 1.8;
            margin-bottom: 30px;
            opacity: 0.95;
        }

        .btn-start {
            padding: 20px 50px;
            font-size: 1.5rem;
            font-weight: 700;
            background: white;
            color: #667eea;
            border: none;
            border-radius: 15px;
            cursor: pointer;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            transition: all 0.3s ease;
        }

        .btn-start:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 40px rgba(0,0,0,0.3);
        }

        /* Feedback zone - compat√≠vel com base.js */
        #feedback-zone {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            padding: 20px 40px;
            border-radius: 15px;
            font-size: 1.3rem;
            font-weight: 600;
            z-index: 9999;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }

        #feedback-zone.show {
            opacity: 1;
            visibility: visible;
        }

        #feedback-zone.correct {
            background: linear-gradient(135deg, #51cf66, #38d9a9);
            color: white;
        }

        #feedback-zone.wrong {
            background: linear-gradient(135deg, #ff6b6b, #ff8787);
            color: white;
        }


        /* Loading */
        .loading {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 2rem;
            color: #667eea;
            z-index: 10000;
        }

        /* ‚úÖ C√ÇMERA INTRO: Zoom in simples (3s) */
        @keyframes cameraZoomIn {
            0% {
                transform: scale(0.6);
            }
            100% {
                transform: scale(1);
            }
        }

        .game-container.camera-intro {
            animation: cameraZoomIn 3s cubic-bezier(0.25, 0.1, 0.25, 1) forwards;
            transform-origin: center center;
        }
    </style>
</head>
<body>
    <div class="game-container">
        <!-- FASE 0: Abertura -->
        <div id="phase-0" class="phase active">
            <div class="welcome-screen">
                <h1>üèîÔ∏è A Montanha do Conhecimento</h1>
                <div class="lume-intro">üåü</div>
                <p>
                    <strong>Lume</strong> precisa escalar a <strong>Montanha do Saber</strong>
                    para recuperar o <strong>Mapa Mundi</strong> roubado pelo Corvo das Trevas!
                </p>
                <p>
                    Responda as perguntas de Geografia e ajude Lume a chegar ao topo.
                    A cada resposta correta, ele sobe mais alto! ü¶Ö‚≠ê
                </p>
                <button class="btn-start" onclick="startGame()">üöÄ COME√áAR AVENTURA</button>
            </div>
        </div>

        <!-- FASES 1-9: Ser√£o injetadas pelo Game Engine -->
        <div id="phase-1" class="phase"></div>
        <div id="phase-2" class="phase"></div>
        <div id="phase-3" class="phase"></div>
        <div id="phase-4" class="phase"></div>
        <div id="phase-5" class="phase"></div>
        <div id="phase-6" class="phase"></div>
        <div id="phase-7" class="phase"></div>
        <div id="phase-8" class="phase"></div>
        <div id="phase-9" class="phase"></div>
    </div>

    <!-- Toast de feedback (nome correto para base.js) -->
    <div id="feedback-zone" class="feedback"></div>

    <!-- Carregar todos os componentes CDN LOCAIS -->
    <script src="../base/scripts/particles.js?v=1762463012"></script>
    <script src="../base/scripts/audio.js?v=1762463012"></script>
    <script src="../base/scripts/base.js?v=1762463012"></script>
    <script src="../base/scripts/game-engine.js?v=1762463012"></script>
    <script src="../mechanics/escalada.js?v=1762463012"></script>
    <script src="../modalities/quiz.js?v=1762463012"></script>
    <script src="../modalities/fill-blanks.js?v=1762463012"></script>
    <script src="../modalities/true-false.js?v=1762463012"></script>
    <script src="../modalities/sequence.js?v=1762463012"></script>

    <script>
        // ===== CONFIGURA√á√ÉO DO JOGO =====
        const gameConfig = {
            titulo: "Lume e a Montanha do Conhecimento",
            tema: "Geografia",
            mecanica: "escalada",
            cenario: "montanha-nevada",  // ‚Üê Op√ß√µes: "montanha-nevada", "deserto-canyon", "cidade-floresta", "vulcao"
            fases: [
                // FASE 0: Abertura (j√° no HTML)
                {
                    numero: 0,
                    type: 'welcome'
                },

                // FASE 1: Quiz (25% - P√°ssaros aparecem)
                {
                    numero: 1,
                    modalidade: 'quiz',
                    dados: {
                        pergunta: "Qual √© o maior pa√≠s do mundo em √°rea?",
                        alternativas: ["R√∫ssia", "Canad√°", "China", "Estados Unidos"],
                        correta: 0,
                        feedback_correto: "‚úÖ Isso! A R√∫ssia tem 17 milh√µes de km¬≤!",
                        feedback_errado: "‚ùå Era R√∫ssia! √â enorme!"
                    }
                },

                // FASE 2: Fill-blanks
                {
                    numero: 2,
                    modalidade: 'fill-blanks',
                    dados: {
                        frase: "A capital do Brasil √© ____",
                        resposta: "Bras√≠lia",
                        variacoes_aceitas: ["Bras√≠lia", "brasilia", "Brasilia"],
                        dica: "Cidade planejada no Centro-Oeste",
                        feedback_correto: "‚úÖ Perfeito! Bras√≠lia √© a capital desde 1960!",
                        feedback_errado: "‚ùå A capital do Brasil √© Bras√≠lia!"
                    }
                },

                // FASE 3: True-False (40% - Nuvens brancas aparecem)
                {
                    numero: 3,
                    modalidade: 'true-false',
                    dados: {
                        afirmacao: "O Rio Nilo est√° localizado no continente africano",
                        correta: true,
                        feedback_correto: "‚úÖ Verdadeiro! O Nilo passa por 11 pa√≠ses da √Åfrica!",
                        feedback_errado: "‚ùå √â verdadeiro! O Nilo fica na √Åfrica."
                    }
                },

                // FASE 4: Quiz
                {
                    numero: 4,
                    modalidade: 'quiz',
                    dados: {
                        pergunta: "Qual oceano banha a costa leste do Brasil?",
                        alternativas: ["Atl√¢ntico", "Pac√≠fico", "√çndico", "√Årtico"],
                        correta: 0,
                        feedback_correto: "‚úÖ Correto! O Oceano Atl√¢ntico banha toda nossa costa!",
                        feedback_errado: "‚ùå √â o Oceano Atl√¢ntico!"
                    }
                },

                // FASE 5: Sequence (60% - Nuvens escuras aparecem)
                {
                    numero: 5,
                    modalidade: 'sequence',
                    dados: {
                        instrucao: "Ordene os pa√≠ses por popula√ß√£o (maior ‚Üí menor):",
                        itens: ["Jap√£o", "China", "√çndia"],
                        ordem_correta: ["China", "√çndia", "Jap√£o"],
                        feedback_correto: "‚úÖ Ordem perfeita! China e √çndia s√£o os mais populosos!",
                        feedback_errado: "‚ùå Ordem: China, √çndia, Jap√£o"
                    }
                },

                // FASE 6: Fill-blanks
                {
                    numero: 6,
                    modalidade: 'fill-blanks',
                    dados: {
                        frase: "O continente com mais pa√≠ses √© a ____",
                        resposta: "√Åfrica",
                        variacoes_aceitas: ["√Åfrica", "africa", "Africa"],
                        dica: "Tem 54 pa√≠ses!",
                        feedback_correto: "‚úÖ Isso! A √Åfrica tem 54 pa√≠ses!",
                        feedback_errado: "‚ùå Era √Åfrica, com 54 pa√≠ses!"
                    }
                },

                // FASE 7: True-False (70% - Urubus aparecem)
                {
                    numero: 7,
                    modalidade: 'true-false',
                    dados: {
                        afirmacao: "A Cordilheira dos Andes fica na Am√©rica do Sul",
                        correta: true,
                        feedback_correto: "‚úÖ Verdadeiro! √â a cadeia montanhosa mais longa do mundo!",
                        feedback_errado: "‚ùå √â verdadeiro! Os Andes ficam na Am√©rica do Sul."
                    }
                },

                // FASE 8: True-False
                {
                    numero: 8,
                    modalidade: 'true-false',
                    dados: {
                        afirmacao: "O Monte Everest √© a montanha mais alta do mundo",
                        correta: true,
                        feedback_correto: "‚úÖ Verdadeiro! O Everest tem 8.848 metros!",
                        feedback_errado: "‚ùå √â verdadeiro! O Everest tem 8.848 metros!"
                    }
                },

                // FASE 9: Quiz (TOPO - Desafio Final!)
                {
                    numero: 9,
                    modalidade: 'quiz',
                    dados: {
                        pergunta: "Qual √© o maior pa√≠s do mundo em √°rea?",
                        alternativas: ["R√∫ssia", "Canad√°", "China", "Estados Unidos"],
                        correta: 0,
                        feedback_correto: "üèÜ CORRETO! Voc√™ conquistou o topo da montanha! üèîÔ∏è‚≠ê",
                        feedback_errado: "‚ùå Era R√∫ssia! Mas tente novamente!"
                    }
                }
            ]
        };

        // ===== INICIAR JOGO =====
        function startGame() {
            console.log('üéÆ Iniciando jogo completo...');

            // üéµ INICIALIZAR SISTEMA DE √ÅUDIO (requer intera√ß√£o do usu√°rio)
            if (window.AUDIO && typeof AUDIO.init === 'function') {
                AUDIO.init();
                AUDIO.playMusic(); // M√∫sica de fundo come√ßa imediatamente
                console.log('üéµ Sistema de √°udio inicializado!');
            }

            // Esconder fase 0
            document.getElementById('phase-0').classList.remove('active');

            // Aguardar transi√ß√£o e ent√£o mostrar fase 1
            setTimeout(() => {
                // Inicializar Game Engine
                const success = GAME_ENGINE.init(gameConfig);

                if (success) {
                    console.log('‚úÖ Game Engine inicializado com sucesso!');
                    console.log('üìä Total de fases:', gameConfig.fases.length);
                    console.log('üé® Cen√°rio:', gameConfig.cenario);
                    console.log('üéÆ Mec√¢nica:', gameConfig.mecanica);

                    // ‚úÖ CORRE√á√ÉO: Sincronizar gameState.totalPhases com window.totalPhases
                    if (window.gameState && window.totalPhases) {
                        window.gameState.totalPhases = window.totalPhases;
                        console.log('‚úÖ gameState.totalPhases atualizado para:', window.totalPhases);
                    }

                    // ‚ú® INICIALIZAR SISTEMA DE PART√çCULAS
                    if (window.PARTICLES && typeof PARTICLES.init === 'function') {
                        PARTICLES.init();
                        console.log('‚ú® Sistema de part√≠culas pronto!');
                    }

                    // ‚úÖ C√ÇMERA INTRO SIMPLES: Zoom in (3s)
                    const gameContainer = document.querySelector('.game-container');

                    console.log('üé¨ Iniciando c√¢mera intro (zoom in simples)...');

                    // 1. Adicionar classe que ativa anima√ß√£o de zoom in
                    gameContainer.classList.add('camera-intro');

                    // 2. Ap√≥s 3s, remover classe e iniciar jogo + VENTO
                    setTimeout(() => {
                        console.log('‚úÖ Zoom in completo!');
                        gameContainer.classList.remove('camera-intro');

                        // üí® INICIAR SOM DO VENTO COM FADE IN
                        if (window.AUDIO && typeof AUDIO.playWind === 'function') {
                            AUDIO.playWind();
                            console.log('üí® Som do vento iniciado!');
                        }

                        nextPhase();
                    }, 3000);
                } else {
                    console.error('‚ùå Erro ao inicializar Game Engine!');
                    alert('Erro ao carregar o jogo. Verifique o console.');
                }
            }, 500);
        }

        // Aguardar carregamento completo
        window.addEventListener('DOMContentLoaded', () => {
            console.log('üì¶ Todos os componentes carregados!');
            console.log('‚úÖ Base:', typeof window.showFeedback !== 'undefined');
            console.log('‚úÖ Game Engine:', typeof window.GAME_ENGINE !== 'undefined');
            console.log('‚úÖ Escalada:', typeof window.ESCALADA !== 'undefined');
            console.log('‚úÖ Quiz:', typeof window.QUIZ !== 'undefined');
            console.log('‚úÖ Fill-blanks:', typeof window.FILL_BLANKS !== 'undefined');
            console.log('‚úÖ True-false:', typeof window.TRUE_FALSE !== 'undefined');
            console.log('‚úÖ Sequence:', typeof window.SEQUENCE !== 'undefined');
            console.log('');
            console.log('üéÆ Clique em "COME√áAR AVENTURA" para iniciar!');
        });
    </script>
</body>
</html>
